'use strict';(function(m,g){"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define(g):(m="undefined"!==typeof globalThis?globalThis:m||self,m.vue_dsl=g())})(this,function(){function m(a,e,c,d,b,f,l){try{var h=a[f](l),q=h.value}catch(n){c(n);return}h.done?e(q):Promise.resolve(q).then(d,b)}function g(a){return function(){var e=this,c=arguments;return new Promise(function(d,b){function f(a){m(h,d,b,f,l,"next",a)}function l(a){m(h,d,b,f,
l,"throw",a)}var h=a.apply(e,c);f(void 0)})}}function t(a,e){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);e&&(d=d.filter(function(d){return Object.getOwnPropertyDescriptor(a,d).enumerable}));c.push.apply(c,d)}return c}function k(a){for(var e=1;e<arguments.length;e++){var c=null!=arguments[e]?arguments[e]:{};e%2?t(Object(c),!0).forEach(function(d){var b=c[d];d in a?Object.defineProperty(a,d,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[d]=b}):
Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):t(Object(c)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(c,d))})}return a}function x(a){return r.apply(this,arguments)}function r(){r=g(function*(a){var e={hint:"Allowed node type that must be ommited",func:function(){var c=g(function*(d,b){return a.reply_template({hasChildren:!1,state:b})});return function(a,b){return c.apply(this,arguments)}}()};return{def_config:k(k({},
e),{x_icons:"desktop_new",x_level:"2",x_text_contains:"config"}),def_modelos:k(k({},e),{x_icons:"desktop_new",x_level:"2",x_text_contains:"modelos"}),def_assets:k(k({},e),{x_icons:"desktop_new",x_level:"2",x_text_contains:"assets"}),def_server:{x_icons:"desktop_new",x_level:"2",x_text_contains:"server|servidor|api",hint:"Representa a un backend integrado con funciones de express.",func:function(){var c=g(function*(d,b){d=a.reply_template();a.x_state.npm=k(k({},a.x_state.npm),{body_parser:"*","cookie-parser":"*"});
a.x_state.central_config.static=!1;return d});return function(a,b){return c.apply(this,arguments)}}()},def_server_path:{x_icons:"list",x_level:"3,4",x_or_isparent:"def_server",x_not_icons:"button_cancel,desktop_new,help",hint:"Carpeta para ubicacion de funcion de servidor",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});if(2==d.level)b.state.current_folder=d.text;else if(3==d.level&&(yield a.isExactParentID(d.id,"def_server_path"))){var f=yield a.dsl_parser.getParentNode({id:d.id});
b.state.current_folder="".concat(f.text,"/").concat(d.id)}else b.valid=!1;return b});return function(a,b){return c.apply(this,arguments)}}()},def_server_func:{x_empty:"icons",x_level:"3,4,5",x_or_isparent:"def_server",hint:"Corresponde a la declaracion de una funcion de servidor",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});a.x_state.central_config.static=!1;b.state.current_func=d.text;2!=d.level&&(yield a.getParentNodes(d.id));b.open="<func_code>";b.close="</func_code>";return b});
return function(a,b){return c.apply(this,arguments)}}()},def_store:{x_icons:"desktop_new",x_level:"2",x_text_contains:"store",hint:"Representa una coleccion de stores de Vue",func:function(){var c=g(function*(d,b){return a.reply_template({state:b,hasChildren:!0})});return function(a,b){return c.apply(this,arguments)}}()},def_store_def:{x_empty:"icons",x_level:"3",x_all_hasparent:"def_store",hint:"Representa a una definicion de store de VueX",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});
var f="normal",c="";b.state.current_store=d.text;a.x_state.stores||(a.x_state.stores={});a.x_state.stores&&!1===d.text in a.x_state.stores&&(a.x_state.stores[d.text]={});Object.keys(d.attributes).map(function(b){b=b.toLowerCase();[":type","type","tipo",":tipo"].includes(b)?["sesion","session"].includes(d.attributes[b])?(f="session",a.x_state.npm["nuxt-vuex-localstorage"]="*"):"local persistent persistente localstorage storage db bd".split(" ").includes(d.attributes[b])&&(f="local",a.x_state.npm["nuxt-vuex-localstorage"]=
"*"):["version",":version"].includes(b)?c=d.attributes[b]:["expire",":expire","expira",":expira"].includes(b)});a.x_state.stores_types&&!1===f in a.x_state.stores_types&&(a.x_state.stores_types[f]={});!1===b.state.current_store in a.x_state.stores_types[f]&&(a.x_state.stores_types[f][b.state.current_store]={});""!=c&&!1===b.state.current_store in a.x_state.stores_types.versions&&(a.x_state.stores_types.versions[b.state.current_store]={});""!=c&&!1===b.state.current_store in a.x_state.stores_types.expires&&
(a.x_state.stores_types.expires[b.state.current_store]={});return b});return function(a,b){return c.apply(this,arguments)}}()},def_proxies:{x_icons:"desktop_new",x_level:2,x_text_contains:"prox",hint:"Representa una coleccion de proxies de Vue",func:function(){var c=g(function*(d,b){return a.reply_template({state:b,hasChildren:!0})});return function(a,b){return c.apply(this,arguments)}}()},def_page:{x_level:"2",x_not_icons:"button_cancel,desktop_new,list,help",x_not_text_contains:"componente:,layout:",
hint:"Archivo vue",func:function(){var c=g(function*(d,b){var f=a.reply_template({state:b});f.state.current_page=d.text;a.x_state.pages[f.state.current_page]||(a.x_state.pages[f.state.current_page]={tipo:"page",acceso:"*",params:"",layout:"",defaults:{},imports:{},components:{},directives:{},variables:{},seo:{},meta:{},head:{script:[],meta:[],seo:{}},var_types:{},proxies:"",return:"",styles:{},script:{},path:"/"+f.state.current_page});d.icons.includes("gohome")&&(a.x_state.pages[f.state.current_page].path=
"/");var c={};Object.keys(d.attributes).map(function(b){var e=d.attributes[b];e=e.replaceAll("$variables.","").replaceAll("$vars.","").replaceAll("$params.","").replaceAll("$config.","process.env").replaceAll("$store.","$store.state.");["proxy"].includes(b.toLowerCase())?a.x_state.pages[f.state.current_page].proxies=e:["acceso","method"].includes(b.toLowerCase())?a.x_state.pages[f.state.current_page].acceso=e:["path","url","ruta"].includes(b.toLowerCase())?a.x_state.pages[f.state.current_page].path=
e:["layout"].includes(b.toLowerCase())?a.x_state.pages[f.state.current_page].layout=e:["meta:title","meta:titulo"].includes(b.toLowerCase())?a.x_state.pages[f.state.current_page].xtitle=e:["background","fondo"].includes(b.toLowerCase())?(c.id="tapa",b=a.getAsset(e,"css"),a.x_state.pages[f.state.current_page].styles["#tapa"]={"background-image":"url('".concat(b,"')"),"background-repeat":"no-repeat","background-size":"100vw"}):":"!=b.charAt(0)&&e!=d.attributes[b]?c[":"+b]=e:c[b]=e}.bind(this));""!=
d.text_note&&(f.open="\x3c!-- ".concat(d.text_note.replaceAll("<br/ >","\n")," --\x3e\n"));f.open+="<template>\n";""==a.x_state.pages[f.state.current_page].layout&&(f.open+="\t"+a.tagParams("v-app",c,!1)+"\n",f.close+="\t</v-app>\n");f.close+="</template>\n";return f});return function(a,b){return c.apply(this,arguments)}}()},def_margen:{x_icons:"idea",x_text_contains:"margen",hint:"Define un margen alrededor del contenido",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});var f=
{};Object.keys(d.attributes).map(function(a){var b=d.attributes[a];b=b.replaceAll("$variables.","").replaceAll("$vars.","").replaceAll("$params.","").replaceAll("$config.","process.env").replaceAll("$store.","$store.state.");if("props"==a.toLowerCase())for(var c of b.split(","))f[c]="vue:prop";else f[a]=b});b.open+=a.tagParams("v-container",f,!1)+"\n";b.close+="</v-container>\n";return b});return function(a,b){return c.apply(this,arguments)}}()},def_contenedor:{x_icons:"idea",x_text_contains:"contenedor",
x_level:">2",hint:"Vue Container",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});var f={refx:d.id};Object.keys(d.attributes).map(function(a){var b=d.attributes[a],c=a.toLowerCase().trim(),e=b.toString().replaceAll("$variables","").replaceAll("$vars.","").replaceAll("$params.","").replaceAll("$env.","process.env.").replaceAll("$store.","$store.state.").trim();if("props"==c)for(var l of e.split(","))f[l]="vue:prop";else":"!=c.charAt(0)&&""!=b&&b!=e?f[":"+a.trim()]=e:f[a.trim()]=
e}.bind(this));""!=d.text_note&&(b.open="\x3c!-- ".concat(d.text_note," --\x3e\n"));b.open+=a.tagParams("v-container",f,!1)+"\n";b.close="</v-container>\n";return b});return function(a,b){return c.apply(this,arguments)}}()},def_flex:{x_icons:"idea",x_text_contains:"flex",x_not_text_contains:":",hint:"Columna de ancho flexible",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});var f={refx:d.id};""!=d.text_note&&(b.open="\x3c!-- ".concat(d.text_note," --\x3e"));Object.keys(d.attributes).map(function(a){var b=
d.attributes[a],c=a.toLowerCase().trim(),e=b.toString().replaceAll("$variables","").replaceAll("$vars.","").replaceAll("$params.","").replaceAll("$env.","process.env.").replaceAll("$store.","$store.state.").trim(),l=0;-1!=e.indexOf("%")&&(e=parseInt(e.replaceAll("%","").trim()),l=Math.round(12*e/100));if("class"==c)f.class=e;else if("props"==c)for(var g of e.split(","))f[g]="vue:prop";else["padding","margen"].includes(c)?f["pa-"+e]="vue:prop":"ancho"==c?f=k(k({},f),v("xs-".concat(l,",sm-").concat(l,
",md-").concat(l,",lg-").concat(l),"vue:prop")):"offset"==c?f=k(k({},f),v("offset-xs-".concat(l,",offset-sm-").concat(l,",offset-md-").concat(l,",offset-lg-").concat(l),"vue:prop")):["muy chico","movil","small","mobile"].includes(c)?f["xs".concat(l)]="vue:prop":["chico","tablet","small","tableta"].includes(c)?f["sm".concat(l)]="vue:prop":["medio","medium","average"].includes(c)?f["md".concat(l)]="vue:prop":["grande","pc","desktop","escritorio"].includes(c)?f["lg".concat(l)]="vue:prop":"xfila:grande xfila:pc xfila:desktop pc escritorio xfila:escritorio".split(" ").includes(c)?
f["lg".concat(Math.round(12/e))]="vue:prop":["xfila:medio","xfila:tablet","tablet","xfila"].includes(c)?f["md".concat(Math.round(12/e))]="vue:prop":["xfila:chico","xfila:movil","xfila:mobile"].includes(c)?f["sm".concat(Math.round(12/e))]="vue:prop":["xfila:muy chico","xfila:movil chico","xfila:small mobile"].includes(c)?f["xs".concat(Math.round(12/e))]="vue:prop":["muy chico:offset","movil:offset","small:offset","mobile:offset"].includes(c)?f["offset-xs".concat(Math.round(12/e))]="vue:prop":["chico:offset",
"tablet:offset","small:offset","tableta:offset"].includes(c)?f["offset-sm".concat(Math.round(12/e))]="vue:prop":["medio:offset","medium:offset","average:offset"].includes(c)?f["offset-md".concat(Math.round(12/e))]="vue:prop":["grande:offset","pc:offset","desktop:offset","escritorio:offset","grande:left"].includes(c)?f["offset-lg".concat(Math.round(12/e))]="vue:prop":":"!=c.charAt(0)&&""!=b&&b!=e?f[":"+a.trim()]=e:f[a.trim()]=e});b.open+=a.tagParams("v-flex",f,!1)+"\n";b.close="</v-flex>\n";return b});
return function(a,b){return c.apply(this,arguments)}}()},def_spacer:{x_icons:"idea",x_text_contains:"spacer",hint:"Spacer es un espaciador flexible",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});""!=d.text_note&&(b.open="\x3c!-- ".concat(d.text_note," --\x3e"));b.open+=a.tagParams("v-spacer",{},!0)+"\n";return b});return function(a,b){return c.apply(this,arguments)}}()},def_center:{x_icons:"idea",x_text_contains:"centrar",hint:"Centra nodos hijos",func:function(){var c=g(function*(d,
b){b=a.reply_template({state:b});var c={refx:d.id,class:"text-xs-center"};""!=d.text_note&&(b.open="\x3c!-- ".concat(d.text_note," --\x3e"));b.open=a.tagParams("div",c,!1)+"<center>\n";b.close+="</center></div>\n";return b});return function(a,b){return c.apply(this,arguments)}}()},def_html:{x_icons:"idea",x_text_contains:"html:",hint:"html:x, donde x es cualquier tag",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});var c={refx:d.id};Object.keys(d.attributes).map(function(b){var f=
d.attributes[b];f=f.replaceAll("$variables.","").replaceAll("$vars.","").replaceAll("$params.","").replaceAll("$config.","process.env").replaceAll("$store.","$store.state.");if("props"==b.toLowerCase())for(var e of f.split(","))c[e]="vue:prop";else if(":"!=b.charAt(0)&&f!=d.attributes[b])c[":"+b]=f;else if("v-model"!=b)if(-1!=a.x_state.central_config.idiomas.indexOf(",")){e=a.x_state.centrar.idiomas.split(",")[0];a.x_state.strings_i18n[e]||(a.x_state.strings_i18n[e]={});var l="t_"+a.hash(f);a.x_state.strings_i18n[e][l]=
f;c[":"+b]="$t('".concat(l,"')")}else c[b]=f;else c[b]=f}.bind(this));""!=d.text_note&&(b.open="\x3c!-- ".concat(d.text_note," --\x3e"));var e=d.text.replace("html:","");b.open+=a.tagParams(e,c,!1)+"\n";b.close+="</".concat(e,">\n");return b});return function(a,b){return c.apply(this,arguments)}}()},def_textonly:{x_level:">2",x_empty:"icons",x_priority:-5,x_or_hasparent:"def_page,def_componente,def_layout",hint:"Texto a mostrar",func:function(){var c=g(function*(d,b){b=a.reply_template({state:b});
var c={class:[]},e,h,g,n=d.text.replaceAll("$variables","").replaceAll("$vars.","").replaceAll("$params.","").replaceAll("$env.","process.env.").replaceAll("$store.","$store.state.");""==n&&(n="&nbsp;");if(1==(yield a.hasParentID(d.id,"def_toolbar"))&&0==(yield a.hasParentID(d.id,"def_slot")))b.valid=!1,b.invalidated_me="def_toolbar";else if(1==(yield a.hasParentID(d.id,"def_variables")))b.valid=!1,b.invalidated_me="def_variables";else if(1==(yield a.hasParentID(d.id,"def_page_estilos")))b.valid=
!1,b.invalidated_me="def_page_estilos";else if(1==(yield a.hasParentID(d.id,"def_page_estilos")))b.valid=!1,b.invalidated_me="def_datatable_headers";else{""!=d.text_note&&(b.open+="\x3c!-- ".concat(d.text_note," --\x3e\n"));if(-1!=d.text.indexOf("..lorem..")&&-1!=d.text.indexOf(":")){var k=d.text.split(":");var p=k[k.length-1]}-1!=d.text.indexOf("numeral(")&&(a.x_state.plugins["vue-numeral-filter"]={global:!0,npm:{"vue-numeral-filter":"*"},config:"{ locale: 'es-es' }"});1==d.font.bold&&c.class.push("font-weight-bold");
10<=d.font.size&&c.class.push("caption");1==d.font.italic&&c.class.push("font-italic");Object.keys(d.attributes).map(function(a){var b=a.toLowerCase().trim(),f=d.attributes[a];"class"==b?c.class.push(f):":span"==b?e=!0:":omit"==b?h=!0:[":length",":largo","len","length","largo"].includes(a)?p=f:"small"==a?g=!0:["ucase","mayusculas","mayuscula"].includes(a)?"true"!=f&&1!=f||c.class.push("text-uppercase"):["capitales","capitalize","capital"].includes(a)?"true"!=f&&1!=f||c.class.push("text-capitalize"):
["lcase","minusculas","minuscula"].includes(a)?"true"!=f&&1!=f||c.class.push("text-lowercase"):"truncate"==a?"true"!=f&&1!=f||c.class.push("text-truncate"):"no-wrap"==a?"true"!=f&&1!=f||c.class.push("text-no-wrap"):["weight","peso","grosor"].includes(a)?(a=f.toLowerCase(),["thin","fina","100"].includes(a)?c.class.push("font-weight-thin"):["light","300"].includes(a)?c.class.push("font-weight-light"):["regular","400"].includes(a)?c.class.push("font-weight-light"):["medium","500"].includes(a)?c.class.push("font-weight-medium"):
["bold","700"].includes(a)?c.class.push("font-weight-bold"):["black","gruesa","900"].includes(a)&&c.class.push("font-weight-black")):"color"==a?-1!=a.indexOf(" ")?(a=f.split(" "),c.class.push("".concat(a[0],"--text text--").concat(a[1]))):c.class.push("".concat(f,"--text")):"align"==a?(a=f.toLowerCase(),["center","centro","centrar"].includes(a)?c.class.push("text-xs-center"):["right","derecha"].includes(a)?c.class.push("text-xs-right"):["left","izquierda","izquierdo"].includes(a)&&c.class.push("text-xs-left")):
"style"==a?(c.style||(c.styles=[]),c.styles.push(f)):":"!=a.charAt(0)&&""!=d.text&&n!=d.text?c[":"+a]=f:c[a]=f});p&&(k=require("lorem-ipsum").loremIpsum,n=k({count:parseInt(p),units:"words"}));g&&(n="<small>".concat(n,"</small>"));c.class=c.class.map(function(a){a.replaceAll("text-h1","display-4").replaceAll("text-h2","display-3").replaceAll("text-h3","display-2").replaceAll("text-h4","display-1").replaceAll("text-h5","headline").replaceAll("text-subtitle-1","subtitle-1").replaceAll("text-subtitle-2",
"subtitle-2").replaceAll("text-h6","title").replaceAll("text-body-1","body-1").replaceAll("text-body-2","body-2").replaceAll("text-caption","caption").replaceAll("text-overline","overline");return a});0<c.class.length&&(c.class=c.class.join(" "));c.style&&(c.styles=c.styles.join(";"));h||(a.hasParentID(d.id,"def_textonly")||e?b.open+=a.tagParams("span",c)+n+"</span>\n":a.hasParentID(d.id,"def_card_title")&&!c.class?b.open+=n+"\n":b.open+=a.tagParams("div",c)+n+"</div>\n")}return b});return function(a,
b){return c.apply(this,arguments)}}()},def_variables:{x_icons:"xmag",x_level:3,x_text_contains:"variables",hint:"Definicion local de variables observadas",func:function(){var c=g(function*(d,b){d=a.reply_template({state:b});"undefined"!==typeof b.current_page&&("undefined"===typeof a.x_state.pages[b.current_page]&&(a.x_state.pages[b.current_page]={}),!1==="variables"in a.x_state.pages[b.current_page]&&(a.x_state.pages[b.current_page].variables={}),!1==="types"in a.x_state.pages[b.current_page]&&(a.x_state.pages[b.current_page].types=
{}));return d});return function(a,b){return c.apply(this,arguments)}}()},def_variables_field:{x_priority:1,x_empty:"icons",x_level:">3",x_all_hasparent:"def_variables",hint:"Campo con nombre de variable observada y tipo",func:function(){var c=g(function*(d,b){var c=a.reply_template({state:b}),e={},h="string",g=d.text.trim(),n=d.level-3;if(g.contains("[")&&g.contains("]")||g.contains("{")&&g.contains("}"))h="string",g="script".concat(d.id);else if(g.contains(":"))h=g.split(":").pop().toLowerCase().trim(),
g=g.split(":")[0].trim();else if(d.nodes_raw&&0<d.nodes_raw.length){var k=yield d.getNodes(),p=!1;for(m of k)m.icons.includes("help")&&(p=!0);0==p&&(h="object")}else h="string";Object.keys(d.attributes).map(function(b){var c=b.toLowerCase().trim(),f=d.attributes[b];["type","tipo",":type",":tipo"].includes(c)?h=f.toLowerCase().trim():["valor","value",":valor",":value"].includes(c)?(b=f.replaceAll("$variables","this.").replaceAll("$vars.","this.").replaceAll("$params.","this.").replaceAll("$env.","process.env.").replaceAll("$store.",
"this.$store.state."),"{now}"==b.toLowerCase().trim()&&(b="new Date()"),b.contains("assets:")&&(b=a.getAsset(b,"js")),e.value=b):c.contains(":")&&(e[b.trim()]=f.trim())});["string","text","texto","script"].includes(h)?e.value=!1==="value"in e?"":e.value.toString():["int","numeric","number","numero"].includes(h)?e.value=!1==="value"in e?0:parseInt(e.value):["float","real","decimal"].includes(h)?e.value=!1==="value"in e?0:parseFloat(e.value):["boolean","boleano","booleano"].includes(h)?!1==="value"in
e?e.value="true"==g?!0:!1:"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1):["array"].includes(h)?(h="array",e.value=!1==="value"in e?[]:JSON.parse(e.value)):["struct","object"].includes(h)&&(h="object",e.value=!1==="value"in e?{}:JSON.parse(e.value));"undefined"!==typeof b.current_page&&(!1===b.current_page in a.x_state.pages&&(a.x_state.pages[b.current_page]={}),!1==="variables"in a.x_state.pages[b.current_page]&&(a.x_state.pages[b.current_page].variables={}),!1==="var_types"in a.x_state.pages[b.current_page]&&
(a.x_state.pages[b.current_page].var_types={}));if(1==n)a.x_state.pages[b.current_page].var_types[g]=h,a.x_state.pages[b.current_page].variables[g]=e.value,c.state.vars_path=[g],c.state.vars_types=[h];else{c.state.vars_last_level==n&&(c.state.vars_path.pop(),c.state.vars_types.pop());c.state.vars_path.push(g);if("object"==c.state.vars_types[c.state.vars_types.length-1])w(a.x_state.pages[b.current_page].variables,e.value,c.state.vars_path.join("."));else if("array"==c.state.vars_types[c.state.vars_types.length-
1]){k=[...c.state.vars_path];k.pop();p=y(a.x_state.pages[b.current_page].variables,k.join("."));if(g!=e.value){var m={};m[g]=e.value;p.push(m)}else p.push(e.value);w(a.x_state.pages[b.current_page].variables,p,k.join("."))}c.state.vars_types.push(h);a.x_state.pages[b.current_page].var_types[c.state.vars_path.join(".")]=h}c.state.vars_last_level=n;return c});return function(a,b){return c.apply(this,arguments)}}()},def_variables_watch:{x_icons:"help",x_level:">4",x_text_contains:"change",x_all_hasparent:"def_variables",
hint:"Monitorea los cambios realizados a la variable padre",func:function(){var c=g(function*(c,b){b=a.reply_template({state:b});var d={name:c.text.trim(),type:"watched",oldvar:"old",newvar:"new",deep:!1};Object.keys(c.attributes).map(function(a){var b=a.toLowerCase().trim();a=c.attributes[a];[":old","old"].includes(b)?d.oldvar=a:[":new","new"].includes(b)?d.newvar=a:[":deep","deep"].includes(b)&&(d.deep=a)});d.flat=b.state.vars_path.join(".");b.open=a.tagParams("vue_watched_var",d,!1);""!=c.text_note&&
(b.open+="//".concat(c.text_note,"\n"));b.close="</vue_watched_var>";return b});return function(a,b){return c.apply(this,arguments)}}()},def_variables_func:{x_icons:"help",x_level:4,x_not_text_contains:":server,condicion si,otra condicion",x_all_hasparent:"def_variables",hint:"Variable tipo funcion",func:function(){var c=g(function*(c,b){b=a.reply_template({state:b});var d={name:c.text.trim(),type:"computed"},e="async";Object.keys(c.attributes).map(function(a){var b=a.toLowerCase().trim().replaceAll(":",
"");a=c.attributes[a].trim();"default"==b?d.valor=a:["valor","value"].includes(b)?d.valor=a:"lazy"==b?d.lazy="true"==a?!0:!1:"observar onchange cambie cambien modifiquen cuando monitorear watch".split(" ").includes(b)?d.watch=a:"async"==b&&(e="true"==a?"async":"sync")});"async"==e?(a.x_state.plugins["vue-async-computed"]={global:!0,npm:{"vue-async-computed":"*"}},b.open=a.tagParams("vue_async_computed",d,!1),""!=c.text_note&&(b.open+="//".concat(c.text_note,"\n")),b.close="</vue_async_computed>\n"):
(b.open=a.tagParams("vue_computed",d,!1),""!=c.text_note&&(b.open+="//".concat(c.text_note,"\n")),b.close="</vue_computed>\n");return b});return function(a,b){return c.apply(this,arguments)}}()},def_responder:{x_icons:"desktop_new",x_text_contains:"responder",x_not_text_contains:"traducir,struct,extender",x_all_hasparent:"def_variables",hint:"Emite una respuesta para la variable de tipo funcion",func:function(){var c=g(function*(c,b){b=a.reply_template({state:b});""!=c.text_note&&(b.open="//".concat(c.text_note,
"\n"));c=a.dsl_parser.findVariables({text:c.text,symbol:'"',symbol_closing:'"'});c.contains("**")?(c=a.dsl_parser.replaceVarsSymbol({text:c,from:{open:"**",close:"**"},to:{open:"${",close:"}"}}),b.open+="return `".concat(c,"`;\n")):c.contains("$")?(c=c.replaceAll("$params","this.").replaceAll("$variables","this."),b.open+="return ".concat(c,";\n")):c.contains("assets:")?(c=a.getAsset(c,"js"),b.open+="return ".concat(c,";\n")):""==c?b.open+="return '';\n":"("==c.charAt(0)&&")"==c.slice(-1)?(c=c.slice(1).slice(0,
-1),b.open+="return ".concat(c,";\n")):a.x_state.central_config.idiomas&&a.x_state.central_config.idiomas.contains(",")||(b.open+="return '".concat(c,"';\n"));return b});return function(a,b){return c.apply(this,arguments)}}()}}});return r.apply(this,arguments)}function v(a,e){var c=a;if("string"===typeof c){c={};a=a.split(",");for(var d in a)c[a[d]]=e}else for(var b in c)c[b]=e;return c}function w(a,e,c){var d;c=c.split(".");for(d=0;d<c.length-1;d++)a=a[c[d]];a[c[d]]=e}function y(a,e){return e.split(".").reduce((a,
d)=>a[d],a)}String.prototype.replaceAll=function(a,e){a=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return this.replace(new RegExp(a,"ig"),e)};String.prototype.contains=function(a){return-1!=this.indexOf(a)?!0:!1};var z=require("concepto");class A extends z{constructor(a){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};e=k(k({},{class:"vue",debug:!0}),e);super(a,e)}onInit(){var a=this;return g(function*(){yield a.addCommands(x);a.x_crypto_key=require("crypto").randomBytes(32);a.x_state=
{plugins:{},npm:{},dev_npm:{},envs:{},funciones:{},proxies:{},pages:{},current_func:"",current_folder:"",current_proxy:"",strings_i18n:{},stores_types:{versions:{},expires:{}}};a.x_state.config_node=yield a._readConfig();a.x_state.central_config=yield a._readCentralConfig();a.x_state.assets=yield a._readAssets();a.x_state.dirs=a.x_state.central_config.componente?yield a._appFolders({components:"",pages:"",assets:"assets/","static":"static/",umd:"umd/"}):yield a._appFolders({client:"client/",layouts:"client/layouts/",
components:"client/components/",pages:"client/pages/",plugins:"client/plugins/","static":"client/static/",middleware:"client/middleware/",server:"client/server/",assets:"client/assets/",css:"client/assets/css/",store:"client/store/",lang:"client/lang/"});a.x_state.models=yield a._readModelos();a.x_state.nuxt_is_running=yield a._isLocalServerRunning();a.debug("is Server Running: "+a.x_state.nuxt_is_running);if(a.x_state.config_node.copiar){var e=require("path"),c=e.dirname(e.resolve(a.x_flags.dsl)),
d=require("recursive-copy");a.x_console.outT({message:"copying config:copiar directories to 'static' target folder",color:"yellow"});yield Object.keys(a.x_state.config_node.copiar).map(function(){var a=g(function*(a){a=e.join(c,a);try{yield d(a,this.x_state.dirs.static)}catch(u){"EEXIST"!=u.code&&this.x_console.outT({message:"error: copying directory ".concat(a),data:u})}});return function(b){return a.apply(this,arguments)}}().bind(a));a.x_console.outT({message:"copying config:copiar directories ... READY",
color:"yellow"})}if(a.x_state.config_node["nuxt:icon"]){a.x_state.npm["@nuxtjs/pwa"]="*";var b=require("path"),f=b.dirname(b.resolve(a.x_flags.dsl));b=b.join(f,a.x_state.config_node["nuxt:icon"]);f=a.x_state.dirs.static+"icon.png";a.debug({message:"NUXT ICON dump (copy icon)",color:"yellow",data:b});var l=require("fs").promises;try{yield l.copyFile(b,f)}catch(q){a.x_console.outT({message:"error: copying NUXT icon",data:q})}}a.x_state.config_node["google:adsense"]&&(a.x_state.npm["vue-google-adsense"]=
"*",a.x_state.npm["vue-script2"]="*");a.x_state.config_node["google:analytics"]&&(a.x_state.npm["@nuxtjs/google-gtag"]="*");a.x_state.central_config.componente?(a.x_console.outT({message:"vue initialized() -> as component/plugin"}),a.x_state.npm.global="^4.4.0",a.x_state.npm.poi="9",a.x_state.npm.underscore="*",a.x_state.dev_npm["@vue/test-utils"]="^1.0.0-beta.12",a.x_state.dev_npm["babel-core"]="^6.26.0",a.x_state.dev_npm["babel-preset-env"]="^1.6.1",a.x_state.dev_npm.jest="^22.4.0",a.x_state.dev_npm["jest-serializer-vue"]=
"^0.3.0",a.x_state.dev_npm.vue="*",a.x_state.dev_npm["vue-jest"]="*",a.x_state.dev_npm["vue-server-renderer"]="*",a.x_state.dev_npm["vue-template-compiler"]="*"):(a.x_console.outT({message:"vue initialized() ->"}),a.x_state.plugins["vue-moment"]={global:!0,npm:{"vue-moment":"*"},extra_imports:["moment"],requires:["moment/locale/es"],config:"{ moment }"},a.x_state.npm["@nuxtjs/axios"]="*",a.x_state.npm.nuxt="latest"==a.x_state.central_config.nuxt?"*":"2.11.0",a.x_state.npm.express="*",a.x_state.npm["serverless-http"]=
"*",a.x_state.npm["serverless-apigw-binary"]="*",a.x_state.npm.underscore="*",a.x_state.dev_npm["serverless-prune-plugin"]="*",a.x_state.dev_npm["serverless-offline"]="*",a.x_state.dev_npm["vue-beautify-loader"]="*",a.x_state.central_config.dominio&&(a.x_state.dev_npm["serverless-domain-manager"]="*"));b=function(b){["aurora","vpc","aws"].includes(b)&&"object"===typeof a.x_state.config_node[b]&&Object.keys(a.x_state.config_node[b]).map(function(a){this.x_state.envs["config.".concat(b,".").concat(a)]=
"process.env.".concat((b+"_"+a).toUpperCase())}.bind(a))};for(var h in a.x_state.config_node)b(h)})()}onAfterProcess(a){return g(function*(){return a})()}onDefineTitle(a){var e=this;return g(function*(){var c=a.text;Object.keys(a.attributes).map(function(d){if("title"==d||"titulo"==d)return c=a.attributes[d],!1}.bind(e));return c})()}onDefineFilename(a){var e=this;return g(function*(){var c=a.text;c=c.replace(/ /g,"_")+".vue";a.icons.includes("gohome")?c=1==e.x_state.central_config.componente&&e.x_state.central_config.service_name?
e.x_state.central_config.service_name+".vue":"index.vue":a.icons.includes("desktop_new")?-1!=a.text.indexOf("assets")?c="internal_assets.omit":-1!=a.text.indexOf("store")?c="internal_stores.omit":-1!=a.text.indexOf("proxy")||-1!=a.text.indexOf("proxies")?c="internal_middleware.omit":-1!=a.text.indexOf("config")?c="config.omit":-1!=a.text.indexOf("modelos")?c="modelos.omit":["servidor","server","api"].includes(a.text)&&(c="server.omit"):-1!=a.text.indexOf("componente:")?c=a.text.split(":")[a.text.split(":").length-
1]+".vue":-1!=a.text.indexOf("layout:")&&(c=a.text.split(":")[a.text.split(":").length-1]+".vue");return c})()}onDefineNodeName(a){return g(function*(){return a.text.replace(" ","_")})()}onCompleteCodeTemplate(a){return g(function*(){return a})()}onPrepare(){var a=this;return g(function*(){if(!a.x_state.central_config.componente&&a.x_state.central_config.deploy&&-1!=a.x_state.central_config.deploy.indexOf("eb:")){var e=require("ini"),c=require("path"),d=require("fs").promises,b=require("os"),f="";
b=c.join(b.homedir(),"/.aws/")+"credentials";try{f=yield d.readFile(b,"utf-8")}catch(h){}if(a.x_state.config_node.aws){if(""!=f){var g=c.dirname(c.resolve(a.x_flags.dsl));c=c.join(g,"aws_backup.ini");a.x_console.outT({message:"config:aws:creating .aws/credentials backup",color:"yellow"});yield d.writeFile(c,f,"utf-8")}a.x_console.outT({message:"config:aws:access ->".concat(a.x_state.config_node.aws.access)});a.x_console.outT({message:"config:aws:secret ->".concat(a.x_state.config_node.aws.secret)});
e=e.stringify({aws_access_key_id:a.x_state.config_node.aws.access,aws_secret_access_key:a.x_state.config_node.aws.secret},{section:"default"});a.debug("Setting .aws/credentials from config node");yield d.writeFile(b,e,"utf-8")}else""!=f&&(d=e.parse(f),d.default&&a.debug("Using local system AWS credentials",d.default),a.x_state.config_node.aws={access:"",secret:""},d.default.aws_access_key_id&&(a.x_state.config_node.aws.access=d.default.aws_access_key_id),d.default.aws_secret_access_key&&(a.x_state.config_node.aws.secret=
d.default.aws_secret_access_key))}})()}onErrors(a){return g(function*(){})()}onCreateFiles(a){var e=this;return g(function*(){e.x_console.out({message:"onCreateFiles",data:a});e.x_console.out({message:"pages state",data:e.x_state.pages})})()}_isLocalServerRunning(){var a=this;return g(function*(){return yield require("is-port-reachable")(a.x_state.central_config.port)})()}_readModelos(){var a=this;return g(function*(){a.debug("_readModelos");a.debug_time({id:"readModelos"});var e=yield a.dsl_parser.getNodes({text:"modelos",
level:2,icon:"desktop_new",recurse:!0}),c={},d={tables:{},attributes:{},length:0,doc:""},b={id:{value:"INT AUTOINCREMENT PRIMARY KEY",alias:["identificador","autoid","autonum","key"]},texto:{value:"STRING",alias:["text","varchar","string"]},int:{value:"INTEGER",alias:["numero chico","small int","numero"]},float:{value:"FLOAT",alias:["decimal","real"]},boolean:{value:"BOOLEAN",alias:["boleano","true/false"]},date:{value:"DATEONLY",alias:["fecha"]},datetime:{value:"DATETIME",alias:["fechahora"]},blob:{value:"BLOB",
alias:["binario","binary"]}};Object.keys(b).map(function(a){var d=b[a].alias;d.push(a);d.map(d=>{c[d]=b[a].value})});if(0<e.length){d.attributes=k({},e[0].attributes);d.doc=e[0].text_note;d.length=e[0].nodes.length;for(var f of e[0].nodes){var g=k({},f.attributes);d.tables[f.text]={fields:{}};e=[];for(var h in g)d.tables[f.text].fields[h]=c[g[h]],e.push(h+" "+c[g[h]]);d.tables[f.text].sql="CREATE TABLE ".concat(f.text,"(").concat(e.join(","),")")}}a.debug_timeEnd({id:"readModelos"});if(0<d.length){f=
[];for(var m in d.tables)f.push("alasqlJs('".concat(d.tables[m].sql,"');"));m="const alasql = {\n\t\t\t\tinstall (v) {\n\t\t\t\t\t// create tables from models\n\t\t\t\t\t".concat(f.join("\n"),"\n\t\t\t\t\tVue.prototype.alasql = alasqlJs;\n\t\t\t\t}\n\t\t\t}");a.x_state.plugins["../../node_modules/alasql/dist/alasql.min.js"]={global:!0,npm:{alasql:"*"},var:"alasqlJs",mode:"client",customvar:"alasql",custom:m}}return d})()}_readAssets(){var a=this;return g(function*(){var e={},c=require("path");a.debug("_readAssets");
a.debug_time({id:"_readAssets"});var d=yield a.dsl_parser.getNodes({text:"assets",level:2,icon:"desktop_new",recurse:!0}),b=c.sep;if(0<d.length){d=d[0];for(var f of d.nodes)if(1==f.nodes.length&&""!=f.nodes[0].image)e[f.text.toLowerCase()]={i18n:!1,original:f.nodes[0].image,css:"~assets"+b+c.basename(f.nodes[0].image),js:"~"+b+"assets"+b+c.basename(f.nodes[0].image)};else if(1<f.nodes.length){d=f.text.toLowerCase();e[d]={i18n:!0,i18n_keys:[]};for(var g of f.nodes){var h=k({},g.attributes);h.idioma&&
""!=g.image&&(h=h.idioma.toLowerCase(),e[d].i18n_keys.push(h),e[d][h]={original:g.image,css:"~assets"+b+c.basename(g.image),js:"~"+b+"assets"+b+c.basename(g.image)})}e[d].i18n_keys=e[d].i18n_keys.join(",")}else""!=f.link&&(e[f.text.toLowerCase()]={original:f.link,css:"~assets"+b+c.basename(f.link),js:"~"+b+"assets"+b+c.basename(f.link)})}a.debug_timeEnd({id:"_readAssets"});return e})()}_readCentralConfig(){var a=this;return g(function*(){a.debug("_readCentralConfig");var e=yield a.dsl_parser.getNodes({level:1,
recurse:!1}),c={cloud:"aws",type:"simple",i18n:!1,log:"console",debug:!1,deploy:!1,static:!1,timeout:30,modelos:"aurora",componente:!1,"keep-alive":!0,"keep-warm":!0,port:3E3,git:!0,nuxt:"2.11.0",idiomas:"es",":cache":a.x_config.cache,":mode":"spa",":keywords":"",":author":"Punto Origen SpA",":license":"MIT",":github":"",":version":"1.0.0",":description":e[0].text_note,default_face:e[0].font.face,default_size:e[0].font.size,apptitle:e[0].text};c=k(k({},c),e[0].attributes);c.service_name=c.dominio?
c.dominio.replace(/\./g,"").toLowerCase():c.apptitle;c[":cache"]||(a.x_config.cache=!1);return c})()}_readConfig(){var a=this;return g(function*(){a.debug("_readConfig");var e={id:"",meta:[],seo:{},secrets:{}},c={};c=yield a.dsl_parser.getNodes({text:"config",level:2,icon:"desktop_new",recurse:!0});if(0<c.length){c=c[0];e.default_face=c.font.face;e.default_size=c.font.size;for(var d of c.nodes)if("meta"==d.text.toLowerCase())for(var b of d.nodes)"keywords"==b.text.toLowerCase()?(e.seo.keywords=b.nodes.map(a=>
a.text),e.meta.push({hid:a.hash(b.nodes[0].text),name:"keywords",content:e.seo.keywords.join(",")})):"language"==b.text.toLowerCase()?(e.seo.language=b.nodes[0].text,e.meta.push({hid:a.hash(b.nodes[0].text),lang:b.nodes[0].text})):"charset"==b.text.toLowerCase()?(e.seo.charset=b.nodes[0].text,e.meta.push({charset:b.nodes[0].text})):(e.seo.charset=b.nodes[0].text,-1!=b.text.indexOf(":")?e.meta.push({property:b.text,vmid:b.text,content:b.nodes[0].text}):e.meta.push({hid:a.hash(b.nodes[0].text),name:b.text,
content:b.nodes[0].text}));else if(0<Object.keys(d.attributes).length){c=d.text.toLowerCase().replace(/ /g,"");var f=k({},d.attributes);e[c]=f;d.icons.includes("password")&&(e[c][":secret"]=!0);""!=d.link&&(e[c][":link"]=d.link)}else 0<d.nodes.length?e[d.text]=d.nodes[0].text:""!=d.link&&(e[d.text]=d.link)}e.name||(d=require("path"),b=d.dirname(d.resolve(a.x_flags.dsl)),c=d.resolve(b,"../"),b=b.replace(c,""),e.name=b.replace("/","").replace("\\","")+"_"+d.basename(a.x_flags.dsl,".dsl"));e.id||(e.id=
"com.puntorigen."+e.name);return e})()}getParentNodes(){var a=arguments,e=this;return g(function*(){var c=0<a.length&&void 0!==a[0]?a[0]:e.throwIfMissing("id"),d=1<a.length&&void 0!==a[1]?a[1]:!1,b=yield e.dsl_parser.getParentNodesIDs({id:c,array:!0});c=[];for(var f of b)b=yield e.dsl_parser.getNode({id:f,recurse:!1}),(b=yield e.findValidCommand({node:b,object:d}))&&c.push(b);return c})()}getAsset(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.throwIfMissing("text"),e=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:"js",c=a;a=a.replaceAll("jsfunc","js").toLowerCase();if(-1!=c.toLowerCase().indexOf("assets:")&&c in this.x_state.assets)if(-1!=this.x_state.central_config.idiomas.indexOf(",")&&1==this.x_state.assets[c].i18n){var d=this.x_state.assets[c].i18n_keys.split(",")[0];c=this.x_state.assets[c][d][a];"js"==e.toLowerCase()?(c=c.replaceAll("/".concat(d,"/"),"/' + $i18n.locale + '/"),c="require('".concat(c,"')")):"jsfunc"==e.toLowerCase()&&(c=c.replaceAll("/".concat(d,"/"),
"/' + this.$i18n.locale + '/"),c="require('".concat(c,"')"))}else c in this.x_state.assets&&a in this.x_state.assets[c]&&(c=this.x_state.assets[c][a],-1!=e.toLowerCase().indexOf("js")&&(c="require('".concat(c,"')")));return c}tagParams(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,d=k({},e);"aos"in e&&(e=e.aos.split(","),3==e.length?(d["data-aos"]=e[0],d["data-aos-duration"]=
e[1],d["data-aos-delay"]=e[2]):(d["data-aos"]=e[0],d["data-aos-duration"]=e[1]),delete d.aos);d=this.struct2params(d);a=""!=d?"<".concat(a," ").concat(d):"<".concat(a);1==c&&(a+="/");return a+">"}hash(a){var e=require("highwayhash"),c;"string"===typeof a?c=Buffer.from(a):"object"===typeof a&&(c=Buffer.from(JSON.stringify(a)));return e.asHexString(this.x_crypto_key,c)}}return A})
